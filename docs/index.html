<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="NA">
<title>Approximately balanced estimation of average treatment effects in high dimensions. • balanceHD</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="deps/Roboto-0.4.5/font.css" rel="stylesheet">
<link href="deps/JetBrains_Mono-0.4.5/font.css" rel="stylesheet">
<link href="deps/Roboto_Slab-0.4.5/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Approximately balanced estimation of average treatment effects in high dimensions.">
<meta property="og:description" content="NA">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">balanceHD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="balancehd">balanceHD<a class="anchor" aria-label="anchor" href="#balancehd"></a>
</h1></div>
<p>Estimation of average treatment effects in high dimensions via approximate residual balancing, as proposed by Athey et al. (2016). Fork of Stefan Wager’s original package with some convenience functions + continued development using alternative nuisance function estimators.</p>
<p>To install this package in R, run the following commands:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="kw">library</span>(devtools)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a><span class="kw">install_github</span>(<span class="st">"apoorvalal/balanceHD"</span>)</span></code></pre></div>
<p>This package currently works with three optimizers: <code>mosek</code>, <code>pogs</code>, and <code>quadprog</code>. Mosek is a commercial interior point solver, pogs is a first-order optimizer, based on ADMM, while quadprog is a standard <code>R</code> optimization library. In general, we achieved best performance with mosek, and recommend trying optimizers in the order listed above. We found pogs to be somewhat slower than mosek on the problems we tried. (Note that we offer two solution strategies based on pogs: <code>pogs</code> and <code>pogs.dual</code>. We usually recommend the former, except when p is much larger than n.) Finally, quadprog performors well on small problems, but can be much slower for larger problems.</p>
<p>In terms of availability, the optimizer quadprog is easiest to access, and is available directly from CRAN. Pogs needs to be installed separately, but is still free. To install pogs, simply install one of the pre-compiled binaries available from the project <a href="https://github.com/foges/pogs" class="external-link">repository</a>; see <a href="https://github.com/foges/pogs/blob/master/src/interface_r/README.md" class="external-link">this page</a> for furhter instructions. Finally, mosek is a commercial solver; however, academic <a href="https://www.mosek.com/resources/academic-license" class="external-link">licenses</a> are available for free. One mosek has been installed, we call into it using the R package Rmosek.</p>
<p>Example usage:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="kw">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a><span class="kw">library</span>(balanceHD)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a>n =<span class="st"> </span><span class="dv">400</span>; p =<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>tau =<span class="st"> </span><span class="dv">7</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>nclust =<span class="st"> </span><span class="dv">10</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>beta =<span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span>p) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span>p)<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="co"># cluster assingment</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>clust.ptreat =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>), nclust <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>cluster.center =<span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(nclust <span class="op">*</span><span class="st"> </span>p), nclust, p)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>cluster =<span class="st"> </span><span class="kw">sample.int</span>(nclust, n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a>X =<span class="st"> </span>cluster.center[cluster, ] <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span>p), n, p)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a>W =<span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dv">1</span>, clust.ptreat[cluster])</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a>Y =<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span>tau <span class="op">*</span><span class="st"> </span>W</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a><span class="co"># bad</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a><span class="kw">naive.ate</span>(X, Y, W)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a><span class="co">## [1] 6.339</span></span></code></pre></div>
<div class="section level2">
<h2 id="main-function">main function<a class="anchor" aria-label="anchor" href="#main-function"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="kw">library</span>(tictoc)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="co">## Attaching package: 'tictoc'</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a><span class="co">## The following object is masked from 'package:data.table':</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="co">##     shift</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true"></a><span class="kw">tic</span>()</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true"></a>tau.hat =<span class="st"> </span><span class="kw">residualBalance.ate</span>(X, Y, W, <span class="dt">estimate.se =</span> <span class="ot">TRUE</span>, <span class="dt">optimizer =</span> <span class="st">"mosek"</span>)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true"></a><span class="kw">toc</span>()</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true"></a><span class="co">## 1.355 sec elapsed</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">"true tau:"</span>, tau))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true"></a><span class="co">## [1] "true tau: 7"</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">"point estimate:"</span>, <span class="kw">round</span>(tau.hat[<span class="dv">1</span>], <span class="dv">2</span>)))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true"></a><span class="co">## [1] "point estimate: 6.84"</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true"></a></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">paste0</span>(</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true"></a>  <span class="st">"95% CI for tau: ("</span>, <span class="kw">round</span>(tau.hat[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>tau.hat[<span class="dv">2</span>], <span class="dv">2</span>),</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true"></a>  <span class="st">", "</span>, <span class="kw">round</span>(tau.hat[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>tau.hat[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">")"</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true"></a>))</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true"></a><span class="co">## [1] "95% CI for tau: (6.49, 7.2)"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="alternate-optimizers">alternate optimizers<a class="anchor" aria-label="anchor" href="#alternate-optimizers"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="kw">tic</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>tau.hat =<span class="st"> </span><span class="kw">residualBalance.ate</span>(X, Y, W, <span class="dt">estimate.se =</span> <span class="ot">TRUE</span>, <span class="dt">optimizer =</span> <span class="st">"quadprog"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a><span class="co">## Warning in approx.balance(XW, balance.target, zeta = zeta,</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="co">## allow.negative.weights = allow.negative.weights, : bound.gamma = TRUE not</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a><span class="co">## implemented for this optimizer</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true"></a><span class="co">## Warning in approx.balance(XW, balance.target, zeta = zeta,</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true"></a><span class="co">## allow.negative.weights = allow.negative.weights, : bound.gamma = TRUE not</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true"></a><span class="co">## implemented for this optimizer</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true"></a><span class="kw">toc</span>()</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true"></a><span class="co">## 0.499 sec elapsed</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">"true tau:"</span>, tau))</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true"></a><span class="co">## [1] "true tau: 7"</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">"point estimate:"</span>, <span class="kw">round</span>(tau.hat[<span class="dv">1</span>], <span class="dv">2</span>)))</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true"></a></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true"></a><span class="co">## [1] "point estimate: 6.85"</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true"></a></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">paste0</span>(</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true"></a>  <span class="st">"95% CI for tau: ("</span>, <span class="kw">round</span>(tau.hat[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>tau.hat[<span class="dv">2</span>], <span class="dv">2</span>),</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true"></a>  <span class="st">", "</span>, <span class="kw">round</span>(tau.hat[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>tau.hat[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">")"</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true"></a>))</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true"></a><span class="co">## [1] "95% CI for tau: (6.5, 7.2)"</span></span></code></pre></div>
<p>POGS is good for big problems but takes some setup on linux.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="kw">tic</span>()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>tau.hat =<span class="st"> </span><span class="kw">residualBalance.ate</span>(X, Y, W, <span class="dt">estimate.se =</span> <span class="ot">TRUE</span>, <span class="dt">optimizer =</span> <span class="st">"pogs"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="kw">toc</span>()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="co">## 0.517 sec elapsed</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">"true tau:"</span>, tau))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a><span class="co">## [1] "true tau: 7"</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">"point estimate:"</span>, <span class="kw">round</span>(tau.hat[<span class="dv">1</span>], <span class="dv">2</span>)))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a><span class="co">## [1] "point estimate: 6.85"</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">paste0</span>(</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a>  <span class="st">"95% CI for tau: ("</span>, <span class="kw">round</span>(tau.hat[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>tau.hat[<span class="dv">2</span>], <span class="dv">2</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a>  <span class="st">", "</span>, <span class="kw">round</span>(tau.hat[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="fl">1.96</span> <span class="op">*</span><span class="st"> </span>tau.hat[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">")"</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a>))</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true"></a><span class="co">## [1] "95% CI for tau: (6.5, 7.2)"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="standard-methods">Standard methods<a class="anchor" aria-label="anchor" href="#standard-methods"></a>
</h2>
<div class="section level3">
<h3 id="aipw">AIPW<a class="anchor" aria-label="anchor" href="#aipw"></a>
</h3>
<p>Default elastic net for both outcome model and pscore.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="kw">ipw.ate</span>(X, Y, W, <span class="dt">estimate.se =</span> <span class="ot">TRUE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="co">## [1] 6.8227 0.1432</span></span></code></pre></div>
<p>use grf for pscore</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">ipw.ate</span>(X, Y, W, <span class="dt">prop.method =</span> <span class="st">"randomforest"</span>, <span class="dt">estimate.se =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="co">## [1] 6.9013 0.1283</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="ipw">IPW<a class="anchor" aria-label="anchor" href="#ipw"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="kw">ipw.ate</span>(X, Y, W, <span class="dt">fit.method =</span> <span class="st">"none"</span>, <span class="dt">estimate.se =</span> <span class="ot">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a><span class="co">## [1] 6.3583 0.2557</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="om">OM<a class="anchor" aria-label="anchor" href="#om"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">elnet.ate</span>(X, Y, W, <span class="dt">estimate.se =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="co">## [1] 6.895 0.134</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="double-lasso">double lasso<a class="anchor" aria-label="anchor" href="#double-lasso"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">twostep.lasso.ate</span>(X, Y, W, <span class="dt">estimate.se =</span> <span class="ot">TRUE</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="co">##  [1]   1   2   3   4   5   9  10  16 108 242 284 319 389 509 742 767 808 865 925</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a><span class="co">## [20]  42  82 106 131 149 160 187 231 250 262 278 286 309 316 353 357 359 375 383</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a><span class="co">## [39] 394 395 404 428 456 458 493 496 500 542 545 572 665 705 729 734 739 785 799</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a><span class="co">## [58] 807 814 818 820 892 895 904 911 937 948 958 961 981</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a><span class="co">##  [1]   1   2   3   4   5   9  10  16 108 242 284 319 389 509 742 767 808 865 925</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a><span class="co">## [20]  42  82 106 131 149 160 187 231 250 262 278 286 309 316 353 357 359 375 383</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a><span class="co">## [39] 394 395 404 428 456 458 493 496 500 542 545 572 665 705 729 734 739 785 799</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a><span class="co">## [58] 807 814 818 820 892 895 904 911 937 948 958 961 981</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a><span class="co">##      1        </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a><span class="co">## 6.6556 0.1765</span></span></code></pre></div>
<div class="section level4">
<h4 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h4>
<p>Susan Athey, Guido Imbens, and Stefan Wager. <b>Approximate Residual Balancing: De-Biased Inference of Average Treatment Effects in High Dimensions.</b> 2016. [<a href="http://arxiv.org/pdf/1604.07125.pdf" class="external-link">arxiv</a>]</p>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>NA</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing balanceHD</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Stefan Wager <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Stefan Wager.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
